---
share_link: https://share.note.sx/iqo0r2e6#qns7gUorq3gsEJv66ywL07Wo8tfH2upoa/AJIfdpeoA
share_updated: 2024-12-19T11:01:13+07:00
---

## API ที่ขาด
ขาด API WorkOrderLog นิติ https://abboncorp.atlassian.net/browse/MSM-428
ขาด API ยกเลิกใบงาน นิติ https://abboncorp.atlassian.net/browse/MSM-435
ขาด API approve ยกเลิกใบงาน นิติ https://abboncorp.atlassian.net/browse/MSM-436
ขาด API update WorkOrder นิติ (ขอเงื่อนไขแก้ช่างแก้วันที่ให้ครบในการ์ด) https://abboncorp.atlassian.net/browse/MSM-456
ขาด API update WorkOrder ลูกบ้าน https://abboncorp.atlassian.net/browse/MSM-437
API list ช่าง https://abboncorp.atlassian.net/browse/MSM-351 ยังไม่เสร็จ
Match ช่าง https://abboncorp.atlassian.net/browse/MSM-128
API Get work order juristic https://abboncorp.atlassian.net/browse/MSM-390 [https://ohp5qjc4rd.apidog.io/get-work-order-juristic-12168666e0](https://ohp5qjc4rd.apidog.io/get-work-order-juristic-12168666e0 "https://ohp5qjc4rd.apidog.io/get-work-order-juristic-12168666e0")
API WorkOrderDeleteDraft https://abboncorp.atlassian.net/browse/MSM-462
API UpdateWorkOrderByJuristic https://abboncorp.atlassian.net/browse/MSM-456

---
## POC ที่ติดอยู่

### OTP

POC OTP #3 
เราต้องการ Service OTP API สำหรับ generate OTP เองจาก OTP service provider
ในกรณีที่ลคมี Account อยู่แล้ว ให้เปิดเพิ่มแล้วส่ง endpoint กับ How-to ให้
#### ตอบ ใช้ OTP third party service เป็น API (ขอ document)
#### update 16 Jan 2025 มีเจ้าแล้ว รอ Token กับ เลื่อน priority ไปก่อน รอบัญชี MSM เรื่องงบ
### Mail
ติด User, Password ไม่ถูก Auth ไม่ผ่าน ถ้าเขายืนยันว่าถูกให้ส่ง How-to มาด้วย
เขาให้เมล์เปล่าๆมา FTP user pass ไม่ผ่านใช้ไม่ได้
รอ F เช็คเพิ่ม update ก่อน meeting เย็นนี้
#### ตอบ ใช้ mail service ของเราเอง (Resend)

### Noti
ติด Auth ขอ Full URL กับ How-to มาด้วย
ผล ![[Screenshot 2568-01-02 at 20.25.32.png]]
![[Screenshot 2568-01-02 at 20.27.15.png]]
1. Step ทำ token ผมทำถูกไหมครับ หรือ credential ที่ลูกค้าให้มาใช้ได้ไหมครับ
2. ถ้าส่ง noti ไปหา app ลูกบ้านแบบ 1-1 ใช้เส้นที่เราคุยกันอยู่อันนี้จริงๆใช่ไหมครับ
#### ตอบ รอ Token ที่ถูกส่งมาให้ใหม่อย่างถูกต้อง

### Payment
ขาด Webhook
ตามเอกสาร [https://docs.google.com/spreadsheets/d/1U77vLVs3LFR9Bf2C8Y8x_ZGOuyMuhaMc0Kw_fbBoJic/edit?usp=sharing](https://docs.google.com/spreadsheets/d/1U77vLVs3LFR9Bf2C8Y8x_ZGOuyMuhaMc0Kw_fbBoJic/edit?usp=sharing "https://docs.google.com/spreadsheets/d/1U77vLVs3LFR9Bf2C8Y8x_ZGOuyMuhaMc0Kw_fbBoJic/edit?usp=sharing")
รอ F เช็คเพิ่ม update ก่อน meeting เย็นนี้
#### สรุปทำ API และ document เพื่อรับ webhook ต่อมาอีกทอดนึง (ขอการ์ดทำ webhook เพิ่ม)

### Auth user token
ได้ Token มาแล้ว ต้องการถอด Token ให้ใช้ API เส้นไหน
Clear เรื่อง Table ว่าใช้ Table ไหนใน DB ไหน
#### ตอบ ตาราง Users ของ DB SSO (รอ PROD env)

### POC จาก API ของเมืองทอง เส้น ข่าวสารโครงการ List และ Detail   
https://abboncorp.atlassian.net/browse/MSM-375
สรุป  
Step 1 : ใช้เส้นนี้เพื่อ bypass login  

```
curl 'https://msm-sso.hr-impact.co/api/authentication/authorize' \
  -H 'accept: application/json, text/plain, /' \
  -H 'accept-language: en-US,en;q=0.9' \
  -H 'authorization: Basic TVNNX0FETUlOOkpYcUtlaGtlajNyY3p2Zlo=' \
  -H 'cache-control: no-cache' \
  -H 'content-type: application/json' \
  -H 'dnt: 1' \
  -H 'origin: https://msm-smarty-cms.hr-impact.co' \
  -H 'pragma: no-cache' \
  -H 'priority: u=1, i' \
  -H 'referer: https://msm-smarty-cms.hr-impact.co/' \
  -H 'sec-ch-ua: "Chromium";v="131", "Not_A Brand";v="24"' \
  -H 'sec-ch-ua-mobile: ?1' \
  -H 'sec-ch-ua-platform: "Android"' \
  -H 'sec-fetch-dest: empty' \
  -H 'sec-fetch-mode: cors' \
  -H 'sec-fetch-site: same-site' \
  -H 'user-agent: Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Mobile Safari/537.36' \
  --data-raw '{"username":"0000000000","password":"000000"}'
```

Step 2 : ได้ response.authorizationCode

```
{
    "authentication": true,
    "message": "Authentication successfully",
    "authorizationCode": "Z8vVzNfRBCHHrnyw",
    "redirectURI": null,
    "isDeveloper": true,
    "isTester": true,
    "userGroups": [
        "IM_CHALLENGER",
        "MSM_SMARTY_USER",
        "SUPER_ADMIN",
        "TESTER",
        "MSM_ADMIN_DASHBOARD_16",
        "MSM_ACCOUNTING_ADMIN"
    ]
}
```

Step 3 : เอาไปยิงต่อเพื่อให้ได้ response.accessToken

```
curl 'https://msm-sso.hr-impact.co/api/authentication/authorize/access-token' \
  -H 'accept: application/json, text/plain, */*' \
  -H 'accept-language: en-US,en;q=0.9' \
  -H 'authorization: Basic TVNNX0FETUlOOkpYcUtlaGtlajNyY3p2Zlo=' \
  -H 'cache-control: no-cache' \
  -H 'content-type: application/json' \
  -H 'dnt: 1' \
  -H 'origin: https://msm-smarty-cms.hr-impact.co' \
  -H 'pragma: no-cache' \
  -H 'priority: u=1, i' \
  -H 'referer: https://msm-smarty-cms.hr-impact.co/' \
  -H 'sec-ch-ua: "Chromium";v="131", "Not_A Brand";v="24"' \
  -H 'sec-ch-ua-mobile: ?1' \
  -H 'sec-ch-ua-platform: "Android"' \
  -H 'sec-fetch-dest: empty' \
  -H 'sec-fetch-mode: cors' \
  -H 'sec-fetch-site: same-site' \
  -H 'user-agent: Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Mobile Safari/537.36' \
  --data-raw '{"code":"Z8vVzNfRBCHHrnyw"}'
```

Step 4 : เอาไปยิงต่อเพื่อให้ได้ Noti list

```
curl --location --request GET 'https://msm-accounting-api-staging.hr-impact.co/api/notifications/mass/publish' \
--header 'User-Agent: Apidog/1.0.0 (https://apidog.com)' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzc29DbGllbnQiOnsic3NvQ2xpZW50SWQiOiJkYzZkOWZjYy04YjM2LTRiNmMtYjIzYi05NWNkNGMzMTkxMjQiLCJuYW1lIjoiTVNNX0FETUlOIiwibG9nb1VSSSI6bnVsbCwicmVkaXJlY3RVUkkiOm51bGwsImNsaWVudElkIjoiTVNNX0FETUlOIn0sInVzZXIiOnsidXNlcklkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwiZGlzcGxheU5hbWUiOiJLQVJJUzE0MTIiLCJzdGFmZnMiOlt7InN0YWZmSWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJlbXBsb3llZUlkIjoiMDAwMDAifV0sImlzSW1wYWN0RW1wbG95ZWUiOnRydWUsImlzQWRtaW4iOnRydWUsInVzZXJHcm91cHMiOlt7InVzZXJHcm91cElkIjoiMTZkY2ZjNGEtY2M5OC00NWM0LTgwODEtM2YyZWZjNDI5NmY1IiwiZ3JvdXBJZCI6IklNX0NIQUxMRU5HRVIiLCJpbnRlcm5hbFJvbGUiOm51bGwsInVzZXJJZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsImdyb3VwIjp7Imdyb3VwSWQiOiJJTV9DSEFMTEVOR0VSIiwibmFtZSI6IklNIENoYWxsZW5nZXIiLCJyb2xlIjoiR0VORVJBTCJ9fSx7InVzZXJHcm91cElkIjoiN2RmY2Y4ZjEtNGJhOS00YWE4LWI5YjMtMWNmOTg4NzViODZhIiwiZ3JvdXBJZCI6Ik1TTV9TTUFSVFlfVVNFUiIsImludGVybmFsUm9sZSI6bnVsbCwidXNlcklkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwiZ3JvdXAiOnsiZ3JvdXBJZCI6Ik1TTV9TTUFSVFlfVVNFUiIsIm5hbWUiOiJNU00gU21hcnR5IFVzZXIiLCJyb2xlIjoiR0VORVJBTCJ9fSx7InVzZXJHcm91cElkIjoiOTk0Y2JhNzYtYzRmZS00MTE0LWI0MTctNTU5NWE1NjdhYzQ5IiwiZ3JvdXBJZCI6IlNVUEVSX0FETUlOIiwiaW50ZXJuYWxSb2xlIjpudWxsLCJ1c2VySWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJncm91cCI6eyJncm91cElkIjoiU1VQRVJfQURNSU4iLCJuYW1lIjoiU3VwZXJBZG1pbiIsInJvbGUiOiJTVVBFUl9BRE1JTiJ9fSx7InVzZXJHcm91cElkIjoiZGJjN2QwYjAtYWZkYS00OTAzLWIxY2ItYzIxMjAyZjZiNGE5IiwiZ3JvdXBJZCI6IlRFU1RFUiIsImludGVybmFsUm9sZSI6bnVsbCwidXNlcklkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwiZ3JvdXAiOnsiZ3JvdXBJZCI6IlRFU1RFUiIsIm5hbWUiOiJUZXN0ZXIiLCJyb2xlIjoiQURNSU4ifX0seyJ1c2VyR3JvdXBJZCI6IjAxMjQ4NjliLThkODItNDE5Ni04NmE3LTVmMGI3MWFhYzkxYSIsImdyb3VwSWQiOiJNU01fQURNSU5fREFTSEJPQVJEXzE2IiwiaW50ZXJuYWxSb2xlIjpudWxsLCJ1c2VySWQiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJncm91cCI6eyJncm91cElkIjoiTVNNX0FETUlOX0RBU0hCT0FSRF8xNiIsIm5hbWUiOiJEYXNoYm9hcmQgNSDguKPguLLguKLguIHguLLguKMiLCJyb2xlIjoiR0VORVJBTCJ9fSx7InVzZXJHcm91cElkIjoiYzgyZDAzNWUtNjhjMC00NWVhLTk0ZTAtNzA2ZThhMWVlYzgzIiwiZ3JvdXBJZCI6Ik1TTV9BQ0NPVU5USU5HX0FETUlOIiwiaW50ZXJuYWxSb2xlIjoiMyIsInVzZXJJZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsImdyb3VwIjp7Imdyb3VwSWQiOiJNU01fQUNDT1VOVElOR19BRE1JTiIsIm5hbWUiOiJNU00gQWNjb3VudGluZyBBZG1pbiIsInJvbGUiOiJHRU5FUkFMIn19XX0sImFjY2Vzc1Rva2VuRXhwaXJlZE9uIjoiMjAyNS0wNC0wMlQwNzoyMDo1NS42NjNaIiwiaWF0IjoxNzM1ODAyNDU1fQ.K4GIZIPt1p5Nxo2pDqRn286N7cDjzALtBmgHALG2Q94' \
--header 'Accept: */*' \
--header 'Host: msm-accounting-api-staging.hr-impact.co' \
--header 'Connection: keep-alive' \
--header 'Cookie: msm.sso.sid=WQvLWKhYxBGzdKlp8GXXzXxy1CMKzjT5.QIB%2F%2B%2FYMhu4fzuOwCZKvYlES165l8jzTfT21KUaIhOs' \
--data-raw ''
```

Step 5 : ได้ผลลัพธ์
ยืนยันว่าใช้อันนี้ถูกต้องหรือไม่
#### ตอบ Confirm ว่าใช้ได้เลย

### QR
- ใช้เส้นเดียวกัน 
- ไม่มีวันหมดอายุ 
- ต้องทำ logic กันการจ่ายซ้ำด้วย
- update 02-01-2025 สรุปรอคุยกับ Dev
ต้องการ API document ในการ generate QR code
#### ตอบ ได้ function ในการสร้าง QR มาทำ เป็นการต่อ string เดี๋ยวลอกเลย
#### update 16 Jan 2025 รอ document เพิ่มเติม คาดหมายว่าวันที่ 20 Jan
